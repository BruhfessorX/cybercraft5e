<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Cybercraft Character Sheet</title>
<style>
  body {
    font-family: 'Orbitron', sans-serif;
    background-color: #0e0e0f;
    color: #d0f0ff;
    margin: 0;
  }

  .tabs {
    display: flex;
    justify-content: center;
    background: #111;
    border-bottom: 2px solid #0ff;
  }

  .tab {
    padding: 10px 20px;
    cursor: pointer;
    border: none;
    outline: none;
    background: none;
    color: #0ff;
    font-weight: bold;
    transition: 0.2s;
  }

  .tab.active {
    background: #0ff2;
    color: #fff;
  }

  .tab-content {
    display: none;
    padding: 20px;
  }

  .tab-content.active {
    display: block;
  }

  .terminal-panel {
    position: fixed;
    top: 10px;
    right: 10px;
    width: 280px;
    height: 400px;
    background: rgba(0, 40, 0, 0.85);
    border: 2px solid #00ff9a;
    border-radius: 10px;
    box-shadow: 0 0 20px #00ff9a55;
    padding: 10px;
    overflow-y: auto;
    z-index: 100;
    font-size: 0.9em;
  }

  .terminal-header {
    text-align: center;
    font-weight: bold;
    color: #00ff9a;
    margin-bottom: 8px;
  }

  .roll-history {
    max-height: 260px;
    overflow-y: auto;
    border-top: 1px solid #00ff9a55;
    padding-top: 5px;
    font-family: monospace;
  }

  .roll-line {
    margin: 3px 0;
  }

  .dice-icon {
    cursor: pointer;
    margin-left: 6px;
    font-size: 1.2em;
    color: #00ff9a;
  }

  input, select, textarea {
    background: #111;
    color: #0ff;
    border: 1px solid #0ff5;
    border-radius: 4px;
    padding: 3px;
    width: 100%;
    font-family: inherit;
  }

  .row {
    display: flex;
    gap: 10px;
  }

  .col {
    flex: 1;
  }

  .small-btn {
    background: #00ff9a22;
    border: 1px solid #00ff9a88;
    color: #00ff9a;
    padding: 3px 8px;
    border-radius: 4px;
    cursor: pointer;
    margin-top: 3px;
    transition: 0.2s;
  }

  .small-btn:hover {
    background: #00ff9a44;
  }

  .roll-section {
    margin-bottom: 10px;
  }

  .roll-section label {
    display: block;
    font-weight: bold;
    color: #00ff9a;
  }

  .adv-toggle {
    display: flex;
    justify-content: space-around;
    margin-bottom: 8px;
  }

  .adv-toggle input {
    width: auto;
    margin-right: 5px;
  }
</style>
</head>

<body>
  <div class="tabs">
    <button class="tab active" data-tab="core">Core</button>
    <button class="tab" data-tab="feats">Feats & Cyberware</button>
    <button class="tab" data-tab="spells">Abilities & Spells</button>
    <button class="tab" data-tab="eq">EQ & Notes</button>
    <button class="tab" data-tab="combat">Combat Interface</button>
  </div>

  <div id="core" class="tab-content active">
    <h2>Core</h2>
    <div class="row">
      <div class="col">
        <label>Strength</label><input type="number" id="str" value="10">
        <label>Dexterity</label><input type="number" id="dex" value="10">
        <label>Constitution</label><input type="number" id="con" value="10">
      </div>
      <div class="col">
        <label>Intelligence</label><input type="number" id="int" value="10">
        <label>Wisdom</label><input type="number" id="wis" value="10">
        <label>Charisma</label><input type="number" id="cha" value="10">
      </div>
    </div>

    <div class="row">
      <div class="col">
        <label>AC</label><input type="number" id="ac">
        <label>HP</label><input type="number" id="hp">
        <label>Speed</label><input type="text" id="speed">
      </div>
      <div class="col">
        <label>Sanity</label><input type="number" id="sanity">
        <label>Corruption</label><input type="number" id="corruption">
      </div>
    </div>

    <h3>Saving Throws</h3>
    <div class="row">
      <div class="col"><label>Strength Save</label><input type="number" id="strsave"></div>
      <div class="col"><label>Dexterity Save</label><input type="number" id="dexsave"></div>
      <div class="col"><label>Constitution Save</label><input type="number" id="consave"></div>
    </div>
    <div class="row">
      <div class="col"><label>Intelligence Save</label><input type="number" id="intsave"></div>
      <div class="col"><label>Wisdom Save</label><input type="number" id="wissave"></div>
      <div class="col"><label>Charisma Save</label><input type="number" id="chasave"></div>
    </div>
  </div>

  <div id="feats" class="tab-content">
    <h2>Feats & Cyberware</h2>
    <div id="feats-section">
      <button class="small-btn" onclick="addFeat()">+ Add Feat</button>
      <div id="feats-list"></div>
    </div>
    <div id="cyberware-section">
      <button class="small-btn" onclick="addCyber()">+ Add Cyberware</button>
      <div id="cyber-list"></div>
    </div>
  </div>

  <div id="spells" class="tab-content">
    <h2>Abilities & Spells</h2>
    <div id="abilities-section">
      <button class="small-btn" onclick="addAbility()">+ Add Ability</button>
      <div id="abilities-list"></div>
    </div>
    <div id="spells-section">
      <button class="small-btn" onclick="addSpell()">+ Add Spell</button>
      <div id="spells-list"></div>
    </div>
  </div>

  <div id="eq" class="tab-content">
    <h2>Equipment & Notes</h2>
    <div id="eq-section">
      <button class="small-btn" onclick="addEQ()">+ Add Equipment</button>
      <div id="eq-list"></div>
    </div>
    <div id="vehicles-section">
      <button class="small-btn" onclick="addVehicle()">+ Add Vehicle</button>
      <div id="vehicles-list"></div>
    </div>
    <div id="notes-section">
      <label>Notes</label>
      <textarea rows="5" id="notes"></textarea>
    </div>
  </div>

  <div id="combat" class="tab-content">
    <h2>Combat Interface</h2>
    <p>This panel handles dice rolls, custom formulas, and shows your roll history.</p>
  </div>

  <div class="terminal-panel" id="terminal">
    <div class="terminal-header">Combat Interface</div>
    <div class="adv-toggle">
      <label><input type="radio" name="adv" value="normal" checked> Normal</label>
      <label><input type="radio" name="adv" value="adv"> Adv</label>
      <label><input type="radio" name="adv" value="dis"> Dis</label>
    </div>

    <div class="roll-section">
      <label>Custom Roll</label>
      <input type="text" id="customRoll" placeholder="e.g. 2d8+3" />
      <button class="small-btn" onclick="rollCustom()">Roll</button>
    </div>

    <div class="roll-history" id="rollHistory"></div>
  </div>

<script>
const tabs = document.querySelectorAll('.tab');
const contents = document.querySelectorAll('.tab-content');
tabs.forEach(tab=>{
  tab.addEventListener('click',()=>{
    tabs.forEach(t=>t.classList.remove('active'));
    contents.forEach(c=>c.classList.remove('active'));
    tab.classList.add('active');
    document.getElementById(tab.dataset.tab).classList.add('active');
  });
});

function rollDice(num, sides) {
  let rolls = [];
  for (let i = 0; i < num; i++) rolls.push(Math.floor(Math.random() * sides) + 1);
  return rolls;
}

function parseDice(formula) {
  const match = formula.match(/(\d*)d(\d+)([+-]\d+)?/i);
  if (!match) return null;
  return {
    num: parseInt(match[1]) || 1,
    sides: parseInt(match[2]),
    mod: parseInt(match[3]) || 0
  };
}

function rollCustom() {
  const formula = document.getElementById("customRoll").value;
  const adv = document.querySelector('input[name="adv"]:checked').value;
  const parsed = parseDice(formula);
  if (!parsed) return alert("Invalid formula");
  let rolls = rollDice(parsed.num, parsed.sides);
  let total = rolls.reduce((a,b)=>a+b,0)+parsed.mod;
  let text = `${formula}: [${rolls.join(", ")}] ${parsed.mod>=0?'+':''}${parsed.mod} = ${total}`;
  const hist = document.getElementById("rollHistory");
  const div = document.createElement("div");
  div.className="roll-line";
  div.textContent=text;
  hist.prepend(div);
  if(hist.children.length>30) hist.removeChild(hist.lastChild);
}
</script>
</body>
</html>
